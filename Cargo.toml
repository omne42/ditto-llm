[package]
name = "ditto-llm"
version = "0.1.2"
edition = "2024"
rust-version = "1.85"

[features]
default = ["openai", "anthropic", "openai-compatible", "streaming", "tools", "embeddings"]

# Modules
agent = ["dep:regex", "dep:safe-fs-tools"]
auth = ["dep:hmac", "dep:sha2", "dep:time"]
sdk = []
gateway = ["dep:axum", "dep:regex"]
gateway-devtools = ["gateway", "sdk"]
gateway-translation = ["gateway"]
gateway-proxy-cache = ["gateway"]
gateway-routing-advanced = ["gateway"]
gateway-metrics-prometheus = ["gateway"]
gateway-costing = ["gateway"]
gateway-tokenizer = ["gateway", "dep:tiktoken-rs"]
gateway-store-sqlite = ["gateway", "dep:rusqlite"]
gateway-store-redis = ["gateway", "dep:redis"]
gateway-otel = [
  "gateway",
  "dep:tracing",
  "dep:tracing-subscriber",
  "dep:opentelemetry",
  "dep:opentelemetry_sdk",
  "dep:opentelemetry-otlp",
  "dep:tracing-opentelemetry",
]
base64 = ["dep:base64"]

# Providers
openai = []
anthropic = []
google = []
openai-compatible = ["openai"]
cohere = []
bedrock = ["auth", "base64"]
vertex = ["auth"]

# Optional capabilities
streaming = []
tools = []
embeddings = []
images = []
audio = []
moderations = []
rerank = []
batches = []

# Bundles
all-providers = ["openai", "anthropic", "google", "openai-compatible", "cohere", "bedrock", "vertex"]
all-capabilities = ["streaming", "tools", "embeddings", "images", "audio", "moderations", "rerank", "batches"]
all = ["all-providers", "all-capabilities"]

integration = []

[dependencies]
async-trait = "0.1"
axum = { version = "0.7", optional = true, features = ["json"] }
base64 = { version = "0.22", optional = true }
bytes = "1"
futures-util = "0.3"
hmac = { version = "0.12", optional = true }
reqwest = { version = "0.12", default-features = false, features = ["json", "multipart", "rustls-tls", "stream"] }
safe-fs-tools = { path = "../safe-fs-tools", optional = true }
serde = { version = "1", features = ["derive"] }
serde_json = "1"
sha2 = { version = "0.10", optional = true }
thiserror = "1"
time = { version = "0.3", features = ["formatting", "macros"], optional = true }
tokio = { version = "1", features = ["io-util", "macros", "process", "rt", "rt-multi-thread", "net", "sync", "time"] }
tokio-util = { version = "0.7", features = ["io"] }
rusqlite = { version = "0.32", optional = true, features = ["bundled"] }
redis = { version = "0.32", optional = true, features = ["tokio-comp", "safe_iterators"] }
regex = { version = "1", optional = true }
opentelemetry = { version = "0.31", optional = true, default-features = false, features = ["trace"] }
opentelemetry_sdk = { version = "0.31", optional = true, default-features = false, features = ["rt-tokio", "trace"] }
opentelemetry-otlp = { version = "0.31", optional = true, default-features = false, features = ["http-proto", "reqwest-rustls", "trace"] }
tracing = { version = "0.1", optional = true, features = ["attributes"] }
tracing-subscriber = { version = "0.3", optional = true, features = ["env-filter", "json"] }
tracing-opentelemetry = { version = "0.32", optional = true }
tiktoken-rs = { version = "0.9.1", optional = true }

[dev-dependencies]
httpmock = "0.8.2"
tempfile = "3"
toml = "0.8"
tower = { version = "0.5", features = ["util"] }

[[example]]
name = "multimodal"
required-features = ["base64"]
